LAMMPS (27 Mar 2011)
# 2d SRD test: big + small particles

units		lj
atom_style	colloid
atom_modify	first big
dimension	2

# create big particles with sigma 1.0

lattice		sq 0.4
Lattice spacing in x,y,z = 1.58114 1.58114 1.58114
region		box block 0 10 0 10 -0.5 0.5
create_box	2 box
Created orthogonal box = (0 0 -0.790569) to (15.8114 15.8114 0.790569)
  2 by 2 by 1 processor grid
create_atoms	1 region box
Created 100 atoms
mass		1 1.0
mass		2 0.01

shape		1 1.0 1.0 1.0
shape		2 0.0 0.0 0.0

group		big type 1
100 atoms in group big
velocity	big create 1.44 87287 loop geom

# equilibrate big particles

pair_style	lj/cut 2.5
pair_coeff	1 1 1.0 1.0
pair_coeff	2 2 0.0 1.0 0.0
pair_coeff	1 2 0.0 1.0 0.0

neighbor	0.3 bin
neigh_modify	delay 0 every 1 check yes

fix		1 big nve
fix		2 all enforce2d

run		1000
Memory usage per processor = 2.59465 Mbytes
Step Temp E_pair E_mol TotEng Press 
       0         1.44     -0.54272            0      0.88288    -0.041088 
    1000    1.8791467  -0.97185784            0    0.8884974   0.61487657 
Loop time of 0.0258421 on 4 procs for 1000 steps with 100 atoms

Pair  time (%) = 0.00398111 (15.4056)
Neigh time (%) = 0.00100678 (3.8959)
Comm  time (%) = 0.0163288 (63.1869)
Outpt time (%) = 4.4167e-05 (0.170911)
Other time (%) = 0.0044812 (17.3407)

Nlocal:    25 ave 26 max 23 min
Histogram: 1 0 0 0 0 0 1 0 0 2
Nghost:    47 ave 48 max 46 min
Histogram: 1 0 0 0 0 2 0 0 0 1
Neighs:    114.75 ave 124 max 100 min
Histogram: 1 0 0 0 0 1 0 0 0 2

Total # of neighbors = 459
Ave neighs/atom = 4.59
Neighbor list builds = 129
Dangerous builds = 0

unfix		1
unfix		2

# add small particles as hi density lattice

lattice		sq 0.4
Lattice spacing in x,y,z = 1.58114 1.58114 1.58114
region		plane block 0 10 0 10 -0.001 0.001
lattice		sq 85.0
Lattice spacing in x,y,z = 0.108465 0.108465 0.108465
create_atoms	2 region plane
Created 21316 atoms

group		small type 2
21316 atoms in group small

velocity	small create 1.0 593849 loop geom

# delete overlaps
# must set 1-2 cutoff to non-zero value

pair_style	lj/cut 2.5
pair_coeff	1 1 1.0 1.0
pair_coeff	2 2 0.0 1.0 0.0
pair_coeff	1 2 0.0 1.0 0.5

delete_atoms	overlap 0.5 small big
Deleted 6700 atoms, new total = 14716

# SRD run

reset_timestep	0

neighbor	0.3 bin
neigh_modify	delay 0 every 1 check yes

communicate	multi group big vel yes
neigh_modify	include big

# no pairwise interactions with small particles

pair_style	lj/cut 2.5
pair_coeff	1 1 1.0 1.0
pair_coeff	2 2 0.0 1.0 0.0
pair_coeff	1 2 0.0 1.0 0.0

# use fix SRD to push small particles out from inside big ones

timestep	0.001

fix		1 big nve
fix	        2 small srd 20 big 1.0 0.25 49894 		  radius 0.88 search 0.2 collision slip
fix		3 all enforce2d

# diagnostics

compute		tbig big temp
variable	pebig equal pe*atoms/count(big)
variable	ebig equal etotal*atoms/count(big)
thermo_style	custom step temp f_2[7] etotal v_pebig v_ebig press 		f_2[1] f_2[2] f_2[3] f_2[4] f_2[5] 		f_2[6] f_2[8] f_2[9] f_2[10]

thermo_modify	temp tbig
WARNING: Temperature for thermo pressure is not for group all
thermo		100
dump		1 all atom 250 dump.srd.mixture

run		5000
SRD info:
  SRD/big particles = 14616 100
  big particle diameter max/min = 0.88 0.88
  SRD temperature & lamda = 1 0.2
  SRD max distance & max velocity = 0.8 40
  SRD grid counts: 63 63 1
  SRD grid size: request, actual (xyz) = 0.25, 0.250974 0.250974 1.58114
  SRD per actual grid cell = 4.86648
  SRD viscosity = 0.463448
  big/SRD mass density ratio = 2.12808
WARNING: Fix srd grid size > 1/4 of big particle diameter
  # of rescaled SRD velocities = 0
  ave/max small velocity = 13.2944 24.262
  ave/max big velocity = 1.69284 5.10989
Memory usage per processor = 5.44263 Mbytes
Step Temp 2[7] TotEng pebig ebig Press 2[1] 2[2] 2[3] 2[4] 2[5] 2[6] 2[8] 2[9] 2[10] 
       0    1.8791467            0 0.0060376284  -0.97185784    0.8884974   0.61487657            0            0            0            0            0            0            0            0            0 
     100    1.3582446         3969 0.0026789295  -0.95043087   0.39423126   0.73581726         7479           87           87            0            0        22500         2999    1.0285157            0 
     200    1.2572907         3969 0.0019616669  -0.95603884   0.28867891   0.62749376         7394           98           98            0            0        22500         2994    1.0253343            0 
     300      1.12798         3969 0.00057755533   -1.0317072  0.084993042   0.30262448         7311           88           88            0            0        22500         2997     1.022263            0 
     400    1.1466105         3969 0.00088785773   -1.0044873   0.13065714   0.40537124         7467           82           82            0            0        22500         2993    1.0139003            0 
     500    1.0151043         3969 -0.00021014381   -1.0358781 -0.030924763   0.19673928         7587           81           81            0            0        22500         2994    1.0145019            0 
     600   0.99210691         3969 -0.0002577968   -1.0201232 -0.037937377    0.2625174         7449           92           92            0            0        22500         2968   0.98574736            0 
     700   0.92572874         3969 -0.00067753277   -1.0161772 -0.099705722   0.19520999         7537           78           78            0            0        22500         2998    1.0064032            0 
     800   0.94627244         3969 -0.0003639106   -0.9903628 -0.053553084   0.22241336         7602           79           79            0            1        22500         3010    1.0134331            0 
     900   0.92523394         3969 -0.00080502966   -1.0344498  -0.11846816   0.18846804         7576           72           72            0            1        22500         3015    1.0136704            0 
    1000    1.0322972         3969 -0.00037569219   -1.0772611 -0.055286863   0.13263626         7601           88           88            0            0        22500         3000    1.0224061            0 
    1100    0.9726161         3969 -0.00041776377   -1.0243681 -0.061478117    0.3120931         7425           87           87            0            0        22500         2991    1.0216981            0 
    1200    0.9785542         3969 -0.00036217362   -1.0220661 -0.053297471   0.37956001         7634           94           94            0            0        22500         3022    1.0055215            0 
    1300     1.102684         3969 0.00056306573   -1.0087964  0.082860753   0.50039902         7380           94           94            0            0        22500         3011    1.0298198            0 
    1400    1.2416072         3969 0.0016380507  -0.98813558   0.24105553    0.6709785         7532           95           95            0            0        22500         3005    1.0272106            0 
    1500    1.1009579         3969 0.00041059416   -1.0295252  0.060423037    0.4271012         7443           86           86            0            0        22500         2990    1.0322439            0 
    1600   0.97932726         3969 -0.00044406974   -1.0348833 -0.065349303   0.23710215         7541           85           85            0            0        22500         3005    1.0504545            0 
    1700      1.07156         3969 0.0003309407   -1.0121432  0.048701233   0.32615222         7660           90           90            0            1        22500         3010    1.0192163            0 
    1800   0.94379054         3969 -0.00060529206   -1.0234274  -0.08907478   0.28437994         7706           92           92            0            0        22500         2983    1.0197247            0 
    1900    1.1935542         3969  0.001087796   -1.0215386   0.16008006   0.32082985         7633          102          102            0            0        22500         3026    1.0227294            0 
    2000    1.0794535         3969 0.00017035747   -1.0435892  0.025069805   0.12933714         7547           76           76            0            0        22500         3028    1.0339312            0 
    2100      1.11728         3969  0.001197717  -0.92985122   0.17625603    0.4877601         7424           88           88            0            0        22500         2986    1.0268223            0 
    2200     1.022726         3969 -0.00017383526   -1.0380804 -0.025581597   0.18522494         7414           92           92            0            0        22500         3004    1.0254694            0 
    2300    1.2289681         3969 0.0014918151  -0.99714295   0.21953551   0.56571933         7669           90           90            0            0        22500         3008    1.0265701            0 
    2400    1.0261081         3969 0.00016550325  -0.99149158  0.024355459   0.53332928         7499           83           83            0            0        22500         3019    1.0160353            0 
    2500    1.0155015         3969 -0.00056230464   -1.0880952 -0.082748751   0.22398562         7712           79           79            0            0        22500         3017      1.03801            0 
    2600    0.8756954         3969 -0.0014956069    -1.087032  -0.22009351   0.10400097         7542           85           85            0            0        22500         2985     1.024091            0 
    2700   0.97964461         3969 -0.00075911535   -1.0815596  -0.11171141   0.27927544         7449           86           86            0            0        22500         2993    1.0166909            0 
    2800   0.97102332         3969 -0.00081115436   -1.0806826  -0.11936948   0.36647698         7662           85           85            0            0        22500         3014    1.0148134            0 
    2900    1.1405082         3969 0.00078035444   -1.0142661   0.11483696   0.73653576         7451           82           82            0            0        22500         3007    1.0296379            0 
    3000    1.0460256         3969 -0.00031837206    -1.082417 -0.046851633   0.25310003         7494           83           83            0            0        22500         3013     1.043192            0 
    3100     1.128752         3969 0.00043203186   -1.0538867  0.063577808   0.37101933         7458           89           89            0            1        22500         2981    1.0082866            0 
    3200    1.0546223         3969 0.00023156986   -1.0099982  0.034077821   0.66191884         7451           92           92            0            0        22500         2988    1.0254862            0 
    3300    1.0859707         3969 -5.4375056e-05   -1.0831128 -0.0080018333    0.3552947         7441           74           74            0            0        22500         2978    1.0252244            0 
    3400   0.90831095         3969 -0.0011506108   -1.0685517  -0.16932389   0.26027658         7478           76           76            0            0        22500         2997    1.0306308            0 
    3500    1.0971397         3969 0.00047675241   -1.0160094  0.070158884   0.39394719         7510           87           87            0            0        22500         2999    1.0303505            0 
    3600    1.0758592         3969 5.1451605e-05    -1.057529 0.0075716182   0.23217468         7505           98           98            0            0        22500         3022    1.0133265            0 
    3700   0.99184036         3969 -0.00051911023   -1.0583142 -0.076392262    0.2659259         7566          104          104            0            0        22500         3006    1.0284719            0 
    3800   0.86950687         3969 -0.0014525295    -1.074566  -0.21375425   0.27380224         7552           80           80            0            0        22500         3013    1.0351337            0 
    3900   0.86286132         3969 -0.0010595017    -1.010149  -0.15591627   0.56043933         7547          104          104            0            0        22500         2992    1.0313609            0 
    4000   0.76083626         3969 -0.0014009914   -0.9593978   -0.2061699   0.64813923         7448          101          101            0            0        22500         3032    1.0109258            0 
    4100    1.0071575         3969 -0.00018734554   -1.0246557 -0.027569769   0.55964495         7489           76           76            0            0        22500         3016    1.0175384            0 
    4200   0.88374612         3969 -0.0010981928   -1.0365187  -0.16161005   0.41352036         7481           92           92            0            0        22500         2995    1.0123735            0 
    4300   0.98819505         3969 -0.00066821798   -1.0766481 -0.098334958   0.41489158         7557           79           79            0            0        22500         2998    1.0400745            0 
    4400    1.1772685         3969 0.0010725317    -1.007662   0.15783376    0.7912903         7522           76           76            0            0        22500         2991    1.0176624            0 
    4500    1.0836741         3969 0.00021867511   -1.0406572  0.032180229   0.58489302         7800           93           93            0            0        22500         2997    1.0023484            0 
    4600    1.0334731         3969 -0.00015378918     -1.04577 -0.022631616   0.53872329         7542           94           94            0            0        22500         2996   0.98823241            0 
    4700    1.2126127         3969 0.0011423373   -1.0323802   0.16810636   0.49583696         7387           81           81            0            0        22500         3001    1.0425378            0 
    4800    1.1593219         3969 0.0010239969  -0.99703726   0.15069139   0.37192735         7374           80           80            0            1        22500         2988    1.0278368            0 
    4900   0.87223689         3969 -0.00099601272   -1.0100878  -0.14657323   0.11585542         7448           89           89            0            0        22500         3000    1.0267238            0 
    5000   0.87426493         3969 -0.0010817587   -1.0247139  -0.15919161   0.15322481         7587          100          100            0            0        22500         2988    1.0030228            0 
Loop time of 1.76678 on 4 procs for 5000 steps with 14716 atoms

Pair  time (%) = 0.0225935 (1.27879)
Neigh time (%) = 0.0765792 (4.33439)
Comm  time (%) = 0.132309 (7.48868)
Outpt time (%) = 0.371439 (21.0235)
Other time (%) = 1.16386 (65.8746)

Nlocal:    3679 ave 3872 max 3379 min
Histogram: 1 0 0 0 0 0 1 1 0 1
Nghost:    48.25 ave 51 max 45 min
Histogram: 1 0 0 0 0 1 1 0 0 1
Neighs:    118 ave 167 max 87 min
Histogram: 1 1 0 0 1 0 0 0 0 1

Total # of neighbors = 472
Ave neighs/atom = 0.0320739
Neighbor list builds = 250
Dangerous builds = 0

